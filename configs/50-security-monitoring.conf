# Enhanced security monitoring for RDP and system access
# RDP login attempts and failures
:programname, isequal, "xrdp" /var/log/rdp-access.log
:programname, isequal, "xrdp-sesman" /var/log/rdp-access.log

# SSH attempts (if enabled)
:programname, isequal, "sshd" /var/log/ssh-access.log

# Sudo usage
:programname, isequal, "sudo" /var/log/sudo-access.log

# Authentication failures
:msg, regex, "authentication failure" /var/log/auth-failures.log
:msg, regex, "FAILED LOGIN" /var/log/auth-failures.log
:msg, regex, "Invalid user" /var/log/auth-failures.log

# Stop processing these messages in other logs to reduce noise
& stop